"use client";
import { useState } from "react";
export default function Admin(){ const [key,setKey]=useState(""); const [orders,setOrders]=useState<any[]>([]); const [items,setItems]=useState<any[]>([]); const load=async()=>{ const res=await fetch(`/api/admin/orders?key=${encodeURIComponent(key)}`); const j=await res.json(); if(!res.ok){ alert(j.error||"Hata"); return;} setOrders(j.orders||[]); setItems(j.items||[]); }; return (<div><h1>Admin</h1><p>Key: <input value={key} onChange={e=>setKey(e.target.value)} placeholder="ADMIN_SECRET"/></p><button onClick={load}>Siparişleri Yükle</button>{orders.map(o=>{ const its=items.filter((it:any)=>it.order_id===o.id); const produced=its.filter((it:any)=>it.produced).length; const remaining=its.filter((it:any)=>!it.produced).length; return (<div key={o.id} style={{border:"1px solid #ddd",padding:10,marginTop:10}}><b>#{o.id}</b> | {o.company_name} | Mail: {o.contact_email} | Toplam (KDV hariç): {o.total_excl_vat} | KDV dahil: {o.total_incl_vat}<div>Kalemler:</div><ul>{its.map((it:any)=>(<li key={it.id}>{it.products?.name} | Adet: {it.quantity} | Renk: {it.color||"-"} | Üretildi: {it.produced?"✔":"✗"} | Paket: {it.packaged?"✔":"✗"} | Sevk: {it.shipped?"✔":"✗"}</li>))}</ul><div>Bugün üretildi (adet): {produced} | Kalan: {remaining}</div></div>); })}</div>); }
